# Part 2: 원본 이미지와 마스크 결합 기반 분류 작업

## **1. 개요**
본 파트에서는 **원본 이미지와 해당 마스크를 결합**하여 새로운 이미지를 생성한 뒤, 이를 기반으로 **분류 작업**을 수행합니다. 
이 작업은 마스크 정보가 원본 이미지의 분류 성능에 어떤 영향을 미치는지 평가하는 것을 목표로 합니다.

---

## **2. 진행 작업**
### **(1) 원본 이미지와 마스크 결합**
- 원본 이미지와 마스크 이미지를 결합하여 새로운 이미지를 생성.
- 마스크는 원본 이미지와 동일한 크기로 조정 후, 색상 채널을 확장하여 결합.

### **(2) 데이터 전처리 및 증강**
- 결합된 이미지를 **전처리 및 증강** 작업을 수행.
- Tensor 형태로 변환 후 저장하여 학습 과정에서 활용.

### **(3) 분류 모델 학습**
- EfficientNet-B1와 ViT(Vision Transformer)를 사용하여 분류 작업 수행.
- 모델 학습 및 검증 후, **Test Accuracy, Precision, Recall, F1 Score** 등의 평가 지표를 기록.

---

## **3. 코드 구성**
본 폴더에는 다음과 같은 4가지 코드가 포함됩니다:
1. **원본 이미지와 마스크 결합 코드**:
   - 원본 이미지와 마스크를 결합하여 새로운 이미지를 생성하는 코드.
2. **데이터 전처리 및 증강 코드**:
   - 결합된 이미지를 전처리하고 Tensor 형태로 저장.
3. **ViT 모델 학습 코드**:
   - Vision Transformer 기반 모델을 학습하고 평가.
4. **EfficientNet-B1 모델 학습 코드**:
   - EfficientNet-B1 기반 모델을 학습하고 평가.

---

## **4. 모델 성능 비교**

### **EfficientNet-B1**
- **Test Accuracy**: 79.56%
- **정밀도 (Precision), 재현율 (Recall), F1 Score**:

| Class  | Precision | Recall | F1 Score | Support |
|--------|-----------|--------|----------|---------|
| bkl    | 0.60      | 0.61   | 0.60     | 107     |
| nv     | 0.86      | 0.95   | 0.91     | 655     |
| df     | 0.60      | 0.25   | 0.35     | 12      |
| mel    | 0.82      | 0.34   | 0.48     | 135     |
| vasc   | 0.57      | 0.75   | 0.65     | 16      |
| bcc    | 0.57      | 0.78   | 0.66     | 49      |
| akiec  | 0.42      | 0.34   | 0.38     | 29      |

### **ViT**
- **Test Accuracy**: 68.49%
- **정밀도 (Precision), 재현율 (Recall), F1 Score**:

| Class  | Precision | Recall | F1 Score | Support |
|--------|-----------|--------|----------|---------|
| bkl    | 0.41      | 0.30   | 0.34     | 107     |
| nv     | 0.75      | 0.93   | 0.83     | 655     |
| df     | 0.00      | 0.00   | 0.00     | 12      |
| mel    | 0.38      | 0.28   | 0.32     | 135     |
| vasc   | 0.00      | 0.00   | 0.00     | 16      |
| bcc    | 0.78      | 0.14   | 0.24     | 49      |
| akiec  | 0.00      | 0.00   | 0.00     | 29      |

---

## **5. 비교 및 관찰**
### **EfficientNet-B1 vs. ViT**
- **EfficientNet-B0**:
  - 전체적인 정확도(79.56%)와 F1 Score에서 **ViT**를 상회.
  - 주요 클래스(nv)에서 강점을 보임.
  - 소수 클래스(df, mel 등)에서도 상대적으로 높은 성능.
- **ViT**:
  - 정확도(68.49%) 및 소수 클래스(df, vasc 등)에서 성능 저조.
  - 데이터 불균형 문제에 취약.

---

## **6. 결론**
- **EfficientNet-B0**:
  - 결합된 마스크 정보 활용 시에도 효율적이며, 전반적인 성능이 우수.
- **ViT**:
  - 모델 튜닝과 데이터 증강을 통해 성능 개선 가능성이 있음.
- **향후 작업 방향**:
  - 데이터 불균형 해소를 위한 증강 기법 활용.
  - 소수 클래스에 대한 학습 보완을 위해 Focal Loss 등 손실 함수 변경 고려.

